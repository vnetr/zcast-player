function t(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function e(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}"function"==typeof SuppressedError&&SuppressedError;const i=globalThis,n=i.ShadowRoot&&(void 0===i.ShadyCSS||i.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,r=Symbol(),s=new WeakMap;let o=class{constructor(t,e,i){if(this._$cssResult$=!0,i!==r)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(n&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=s.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&s.set(e,t))}return t}toString(){return this.cssText}};const a=n?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return(t=>new o("string"==typeof t?t:t+"",void 0,r))(e)})(t):t,{is:l,defineProperty:d,getOwnPropertyDescriptor:u,getOwnPropertyNames:h,getOwnPropertySymbols:c,getPrototypeOf:p}=Object,m=globalThis,y=m.trustedTypes,f=y?y.emptyScript:"",v=m.reactiveElementPolyfillSupport,g=(t,e)=>t,_={toAttribute(t,e){switch(e){case Boolean:t=t?f:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},b=(t,e)=>!l(t,e),$={attribute:!0,type:String,converter:_,reflect:!1,useDefault:!1,hasChanged:b};Symbol.metadata??=Symbol("metadata"),m.litPropertyMetadata??=new WeakMap;let A=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=$){if(e.state&&(e.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((e=Object.create(e)).wrapped=!0),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),n=this.getPropertyDescriptor(t,i,e);void 0!==n&&d(this.prototype,t,n)}}static getPropertyDescriptor(t,e,i){const{get:n,set:r}=u(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get:n,set(e){const s=n?.call(this);r?.call(this,e),this.requestUpdate(t,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??$}static _$Ei(){if(this.hasOwnProperty(g("elementProperties")))return;const t=p(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(g("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(g("properties"))){const t=this.properties,e=[...h(t),...c(t)];for(const i of e)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,i]of e)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const i=this._$Eu(t,e);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Eu(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((t,e)=>{if(n)t.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const n of e){const e=document.createElement("style"),r=i.litNonce;void 0!==r&&e.setAttribute("nonce",r),e.textContent=n.cssText,t.appendChild(e)}})(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$ET(t,e){const i=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,i);if(void 0!==n&&!0===i.reflect){const r=(void 0!==i.converter?.toAttribute?i.converter:_).toAttribute(e,i.type);this._$Em=t,null==r?this.removeAttribute(n):this.setAttribute(n,r),this._$Em=null}}_$AK(t,e){const i=this.constructor,n=i._$Eh.get(t);if(void 0!==n&&this._$Em!==n){const t=i.getPropertyOptions(n),r="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:_;this._$Em=n;const s=r.fromAttribute(e,t.type);this[n]=s??this._$Ej?.get(n)??s,this._$Em=null}}requestUpdate(t,e,i){if(void 0!==t){const n=this.constructor,r=this[t];if(i??=n.getPropertyOptions(t),!((i.hasChanged??b)(r,e)||i.useDefault&&i.reflect&&r===this._$Ej?.get(t)&&!this.hasAttribute(n._$Eu(t,i))))return;this.C(t,e,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,e,{useDefault:i,reflect:n,wrapped:r},s){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,s??e??this[t]),!0!==r||void 0!==s)||(this._$AL.has(t)||(this.hasUpdated||i||(e=void 0),this._$AL.set(t,e)),!0===n&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,i]of t){const{wrapped:t}=i,n=this[e];!0!==t||this._$AL.has(e)||void 0===n||this.C(e,void 0,i,n)}}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach(t=>t.hostUpdate?.()),this.update(e)):this._$EM()}catch(e){throw t=!1,this._$EM(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(t){}firstUpdated(t){}};A.elementStyles=[],A.shadowRootOptions={mode:"open"},A[g("elementProperties")]=new Map,A[g("finalized")]=new Map,v?.({ReactiveElement:A}),(m.reactiveElementVersions??=[]).push("2.1.1");const w=globalThis,R=w.trustedTypes,T=R?R.createPolicy("lit-html",{createHTML:t=>t}):void 0,E="$lit$",x=`lit$${Math.random().toFixed(9).slice(2)}$`,O="?"+x,S=`<${O}>`,P=document,D=()=>P.createComment(""),I=t=>null===t||"object"!=typeof t&&"function"!=typeof t,M=Array.isArray,C="[ \t\n\f\r]",k=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,j=/-->/g,U=/>/g,q=RegExp(`>|${C}(?:([^\\s"'>=/]+)(${C}*=${C}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),N=/'/g,z=/"/g,H=/^(?:script|style|textarea|title)$/i,F=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),L=Symbol.for("lit-noChange"),B=Symbol.for("lit-nothing"),V=new WeakMap,W=P.createTreeWalker(P,129);function K(t,e){if(!M(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==T?T.createHTML(e):e}const Z=(t,e)=>{const i=t.length-1,n=[];let r,s=2===e?"<svg>":3===e?"<math>":"",o=k;for(let e=0;e<i;e++){const i=t[e];let a,l,d=-1,u=0;for(;u<i.length&&(o.lastIndex=u,l=o.exec(i),null!==l);)u=o.lastIndex,o===k?"!--"===l[1]?o=j:void 0!==l[1]?o=U:void 0!==l[2]?(H.test(l[2])&&(r=RegExp("</"+l[2],"g")),o=q):void 0!==l[3]&&(o=q):o===q?">"===l[0]?(o=r??k,d=-1):void 0===l[1]?d=-2:(d=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?q:'"'===l[3]?z:N):o===z||o===N?o=q:o===j||o===U?o=k:(o=q,r=void 0);const h=o===q&&t[e+1].startsWith("/>")?" ":"";s+=o===k?i+S:d>=0?(n.push(a),i.slice(0,d)+E+i.slice(d)+x+h):i+x+(-2===d?e:h)}return[K(t,s+(t[i]||"<?>")+(2===e?"</svg>":3===e?"</math>":"")),n]};class J{constructor({strings:t,_$litType$:e},i){let n;this.parts=[];let r=0,s=0;const o=t.length-1,a=this.parts,[l,d]=Z(t,e);if(this.el=J.createElement(l,i),W.currentNode=this.el.content,2===e||3===e){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(n=W.nextNode())&&a.length<o;){if(1===n.nodeType){if(n.hasAttributes())for(const t of n.getAttributeNames())if(t.endsWith(E)){const e=d[s++],i=n.getAttribute(t).split(x),o=/([.?@])?(.*)/.exec(e);a.push({type:1,index:r,name:o[2],strings:i,ctor:"."===o[1]?tt:"?"===o[1]?et:"@"===o[1]?it:Y}),n.removeAttribute(t)}else t.startsWith(x)&&(a.push({type:6,index:r}),n.removeAttribute(t));if(H.test(n.tagName)){const t=n.textContent.split(x),e=t.length-1;if(e>0){n.textContent=R?R.emptyScript:"";for(let i=0;i<e;i++)n.append(t[i],D()),W.nextNode(),a.push({type:2,index:++r});n.append(t[e],D())}}}else if(8===n.nodeType)if(n.data===O)a.push({type:2,index:r});else{let t=-1;for(;-1!==(t=n.data.indexOf(x,t+1));)a.push({type:7,index:r}),t+=x.length-1}r++}}static createElement(t,e){const i=P.createElement("template");return i.innerHTML=t,i}}function G(t,e,i=t,n){if(e===L)return e;let r=void 0!==n?i._$Co?.[n]:i._$Cl;const s=I(e)?void 0:e._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),void 0===s?r=void 0:(r=new s(t),r._$AT(t,i,n)),void 0!==n?(i._$Co??=[])[n]=r:i._$Cl=r),void 0!==r&&(e=G(t,r._$AS(t,e.values),r,n)),e}class Q{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,n=(t?.creationScope??P).importNode(e,!0);W.currentNode=n;let r=W.nextNode(),s=0,o=0,a=i[0];for(;void 0!==a;){if(s===a.index){let e;2===a.type?e=new X(r,r.nextSibling,this,t):1===a.type?e=new a.ctor(r,a.name,a.strings,this,t):6===a.type&&(e=new nt(r,this,t)),this._$AV.push(e),a=i[++o]}s!==a?.index&&(r=W.nextNode(),s++)}return W.currentNode=P,n}p(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class X{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,i,n){this.type=2,this._$AH=B,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=n,this._$Cv=n?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t?.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=G(this,t,e),I(t)?t===B||null==t||""===t?(this._$AH!==B&&this._$AR(),this._$AH=B):t!==this._$AH&&t!==L&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):(t=>M(t)||"function"==typeof t?.[Symbol.iterator])(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==B&&I(this._$AH)?this._$AA.nextSibling.data=t:this.T(P.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:i}=t,n="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=J.createElement(K(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===n)this._$AH.p(e);else{const t=new Q(n,this),i=t.u(this.options);t.p(e),this.T(i),this._$AH=t}}_$AC(t){let e=V.get(t.strings);return void 0===e&&V.set(t.strings,e=new J(t)),e}k(t){M(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,n=0;for(const r of t)n===e.length?e.push(i=new X(this.O(D()),this.O(D()),this,this.options)):i=e[n],i._$AI(r),n++;n<e.length&&(this._$AR(i&&i._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class Y{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,n,r){this.type=1,this._$AH=B,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=r,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=B}_$AI(t,e=this,i,n){const r=this.strings;let s=!1;if(void 0===r)t=G(this,t,e,0),s=!I(t)||t!==this._$AH&&t!==L,s&&(this._$AH=t);else{const n=t;let o,a;for(t=r[0],o=0;o<r.length-1;o++)a=G(this,n[i+o],e,o),a===L&&(a=this._$AH[o]),s||=!I(a)||a!==this._$AH[o],a===B?t=B:t!==B&&(t+=(a??"")+r[o+1]),this._$AH[o]=a}s&&!n&&this.j(t)}j(t){t===B?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class tt extends Y{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===B?void 0:t}}class et extends Y{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==B)}}class it extends Y{constructor(t,e,i,n,r){super(t,e,i,n,r),this.type=5}_$AI(t,e=this){if((t=G(this,t,e,0)??B)===L)return;const i=this._$AH,n=t===B&&i!==B||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,r=t!==B&&(i===B||n);n&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class nt{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){G(this,t)}}const rt=w.litHtmlPolyfillSupport;rt?.(J,X),(w.litHtmlVersions??=[]).push("3.3.1");const st=globalThis;let ot=class extends A{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,i)=>{const n=i?.renderBefore??e;let r=n._$litPart$;if(void 0===r){const t=i?.renderBefore??null;n._$litPart$=r=new X(e.insertBefore(D(),t),t,void 0,i??{})}return r._$AI(t),r})(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return L}};ot._$litElement$=!0,ot.finalized=!0,st.litElementHydrateSupport?.({LitElement:ot});const at=st.litElementPolyfillSupport;at?.({LitElement:ot}),(st.litElementVersions??=[]).push("4.2.1");const lt=t=>(e,i)=>{void 0!==i?i.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)},dt={attribute:!0,type:String,converter:_,reflect:!1,hasChanged:b},ut=(t=dt,e,i)=>{const{kind:n,metadata:r}=i;let s=globalThis.litPropertyMetadata.get(r);if(void 0===s&&globalThis.litPropertyMetadata.set(r,s=new Map),"setter"===n&&((t=Object.create(t)).wrapped=!0),s.set(i.name,t),"accessor"===n){const{name:n}=i;return{set(i){const r=e.get.call(this);e.set.call(this,i),this.requestUpdate(n,r,t)},init(e){return void 0!==e&&this.C(n,void 0,t,e),e}}}if("setter"===n){const{name:n}=i;return function(i){const r=this[n];e.call(this,i),this.requestUpdate(n,r,t)}}throw Error("Unsupported decorator location: "+n)};function ht(t){return(e,i)=>"object"==typeof i?ut(t,e,i):((t,e,i)=>{const n=e.hasOwnProperty(i);return e.constructor.createProperty(i,t),n?Object.getOwnPropertyDescriptor(e,i):void 0})(t,e,i)}function ct(t){return ht({...t,state:!0,attribute:!1})}function pt(t,e){return(e,i,n)=>((t,e,i)=>(i.configurable=!0,i.enumerable=!0,Reflect.decorate&&"object"!=typeof e&&Object.defineProperty(t,e,i),i))(e,i,{get(){return(e=>e.renderRoot?.querySelector(t)??null)(this)}})}let mt=class extends ot{constructor(){super(...arguments),this.parentDocument=null,this.zoomFactor=1,this.frameRate=30,this.currentTimestamp=0,this.order=0,this.startTimestamp=0,this.endTimestamp=0,this.isPlaying=!1}async play(){this.isPlaying=!0}async pause(){this.isPlaying=!1}async stop(){this.isPlaying=!1}updated(t){super.updated(t)}render(){var t;return this.style.position="absolute",this.style.top="0",this.style.left="0",this.style.overflow="hidden",this.id=(null===(t=this.document)||void 0===t?void 0:t.id)||"item-renderer-"+Math.random().toString(36).substring(2,15),super.render()}};t([ht({type:Object}),e("design:type",Object)],mt.prototype,"document",void 0),t([ht({type:Object}),e("design:type",Object)],mt.prototype,"parentDocument",void 0),t([ht({type:Number}),e("design:type",Object)],mt.prototype,"zoomFactor",void 0),t([ht({type:Number}),e("design:type",Object)],mt.prototype,"frameRate",void 0),t([ht({type:Number}),e("design:type",Object)],mt.prototype,"currentTimestamp",void 0),t([ht({type:Number}),e("design:type",Object)],mt.prototype,"order",void 0),t([ht({type:Number}),e("design:type",Object)],mt.prototype,"startTimestamp",void 0),t([ht({type:Number}),e("design:type",Object)],mt.prototype,"endTimestamp",void 0),t([ht({type:Boolean}),e("design:type",Object)],mt.prototype,"isPlaying",void 0),mt=t([lt("item-renderer")],mt);var yt=mt;const ft=new Map,vt=new Map,gt=new Map,_t=t=>["running","finished"].includes(t.playState);gt.set("easeOutQuad","cubic-bezier(0.25, 0.46, 0.45, 0.94)"),gt.set("ease-in","ease-in"),gt.set("ease-out","ease-out"),gt.set("ease-in-out","ease-in-out"),gt.set("linear","linear"),ft.set("fade",()=>({keyframes:[{opacity:0},{opacity:1}],options:{fill:"forwards"}})),ft.set("slide-left",t=>({keyframes:[{transform:`translate3d(${t.width}px, 0px, 0px)`},{transform:"translate3d(0px, 0px, 0px)"}],options:{fill:"forwards"}})),ft.set("slide-right",t=>({keyframes:[{transform:`translate3d(-${t.width}px, 0px, 0px)`},{transform:"translate3d(0px, 0px, 0px)"}],options:{fill:"forwards"}})),ft.set("slide-up",t=>({keyframes:[{transform:`translate3d(0px, ${t.height}px, 0px)`},{transform:"translate3d(0px, 0px, 0px)"}],options:{fill:"forwards"}})),ft.set("slide-down",t=>({keyframes:[{transform:`translate3d(0px, -${t.height}px, 0px)`},{transform:"translate3d(0px, 0px, 0px)"}],options:{fill:"forwards"}})),vt.set("fade",()=>({keyframes:[{opacity:1},{opacity:0}],options:{fill:"forwards"}})),vt.set("slide-left",t=>({keyframes:[{transform:"translate3d(0px, 0px, 0px)"},{transform:`translate3d(-${t.width}px, 0px, 0px)`}],options:{fill:"forwards"}})),vt.set("slide-right",t=>({keyframes:[{transform:"translate3d(0px, 0px, 0px)"},{transform:`translate3d(${t.width}px, 0px, 0px)`}],options:{fill:"forwards"}})),vt.set("slide-up",t=>({keyframes:[{transform:"translate3d(0px, 0px, 0px)"},{transform:`translate3d(0px, -${t.height}px, 0px)`}],options:{fill:"forwards"}})),vt.set("slide-down",t=>({keyframes:[{transform:"translate3d(0px, 0px, 0px)"},{transform:`translate3d(0px, ${t.height}px, 0px)`}],options:{fill:"forwards"}}));const bt=t=>class extends t{constructor(){super(...arguments),this.onAnimationPlay=t=>{},this.onAnimationFinish=t=>{},this.onAnimationCancel=t=>{}}connectedCallback(){super.connectedCallback(),this.ensureTransitions()}async play(){await super.play(),this.ensureTransitions(),this.playTransitionIn(),this.playTransitionOut()}async pause(){var t,e;await super.pause(),null===(t=this.transitionInAnimation)||void 0===t||t.pause(),null===(e=this.transitionOutAnimation)||void 0===e||e.pause()}async stop(){await super.stop(),this.cleanupAnimations(),this.resetStyling()}updated(t){if(super.updated(t),t.has("currentTimestamp")){const t=Math.max(0,Math.floor(this.currentTimestamp||0)-Math.floor(this.startTimestamp||0)),e=Math.floor(this.endTimestamp||0)-Math.floor(this.startTimestamp||0);if(((t,e,i)=>t<0||t>e||i)(t,e,t<Math.floor(1e3/this.frameRate)))return void this.resetStyling();t>=Math.floor(.5*e)?(this.transitionInAnimation&&_t(this.transitionInAnimation)&&(this.transitionInAnimation.cancel(),this.transitionInAnimation=void 0),this.playTransitionOut()):this.playTransitionIn()}}playTransitionIn(){var t,e,i;const n=Math.max(0,Math.floor(this.currentTimestamp||0)-Math.floor(this.startTimestamp||0)),r=((t,e)=>!!((null==t?void 0:t.transition_in)&&t.transition_in.duration>0&&t.transition_in.duration>=e))(this.document,n);if(null===(t=this.document)||void 0===t||t.id,r){if(!this.transitionInAnimation){const t=null===(e=this.document)||void 0===e?void 0:e.transition_in;t&&"none"!==t.type&&t.duration>0&&(this.transitionInAnimation=this.createTransitionInAnimation(t))}this.transitionInAnimation&&!_t(this.transitionInAnimation)&&(this.transitionInAnimation.currentTime=n,requestAnimationFrame(()=>{var t;null===(t=this.transitionInAnimation)||void 0===t||t.play()}))}else this.transitionInAnimation&&(null===(i=this.transitionInAnimation)||void 0===i||i.pause())}playTransitionOut(){var t,e,i,n,r;const s=Math.max(0,Math.floor(this.currentTimestamp||0)-Math.floor(this.startTimestamp||0)),o=Math.floor(this.endTimestamp||0)-Math.floor(this.startTimestamp||0),a=((t,e,i)=>{var n,r;const s=(null===(n=null==t?void 0:t.transition_out)||void 0===n?void 0:n.duration)||0,o=(null===(r=null==t?void 0:t.transition_in)||void 0===r?void 0:r.duration)||0,a=(null==t?void 0:t.transition_in)&&o>0?o:0,l=Math.max(0,i-s),d=Math.max(a,l);return!!((null==t?void 0:t.transition_out)&&t.transition_out.duration>0&&d<=e&&e<i)})(this.document,s,o);if(null===(t=this.document)||void 0===t||t.id,a){if(!this.transitionOutAnimation){const t=null===(e=this.document)||void 0===e?void 0:e.transition_out;t&&"none"!==t.type&&t.duration>0&&(this.transitionOutAnimation=this.createTransitionOutAnimation(t))}if(this.transitionOutAnimation&&!_t(this.transitionOutAnimation)){this.transitionInAnimation&&(this.transitionInAnimation.cancel(),this.transitionInAnimation=void 0);const t=((t,e)=>Math.max(0,t-e))(o,Math.floor((null===(n=null===(i=this.document)||void 0===i?void 0:i.transition_out)||void 0===n?void 0:n.duration)||0)),e=s-t;this.transitionOutAnimation.currentTime=Math.max(0,e),requestAnimationFrame(()=>{var t;null===(t=this.transitionOutAnimation)||void 0===t||t.play()})}}else this.transitionOutAnimation&&(null===(r=this.transitionOutAnimation)||void 0===r||r.pause())}ensureTransitions(){}createTransitionInAnimation(t){return this.createAnimationFromTransition(t,ft)}createTransitionOutAnimation(t){return this.createAnimationFromTransition(t,vt)}createAnimationFromTransition(t,e){var i,n,r,s,o,a,l,d;const u=(t=>gt.get(t||"linear")||"linear")(t.easing),h=e.get(t.type);if(h){const e={width:(null===(n=null===(i=this.parentDocument)||void 0===i?void 0:i.properties)||void 0===n?void 0:n.width)||(null===(s=null===(r=this.document)||void 0===r?void 0:r.properties)||void 0===s?void 0:s.width)||0,height:(null===(a=null===(o=this.parentDocument)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.height)||(null===(d=null===(l=this.document)||void 0===l?void 0:l.properties)||void 0===d?void 0:d.height)||0},{keyframes:c,options:p}=h(e),m=this.animate(c,{...p,duration:t.duration,easing:u});return m.pause(),m.addEventListener("play",this.onAnimationPlay),m.addEventListener("finish",this.onAnimationFinish),m.addEventListener("cancel",this.onAnimationCancel),m}console.warn("[WARNING] Unknown transition type:",t.type,"on",this.document)}cleanupAnimations(){this.transitionInAnimation&&(this.transitionInAnimation.removeEventListener("play",this.onAnimationPlay),this.transitionInAnimation.removeEventListener("finish",this.onAnimationFinish),this.transitionInAnimation.removeEventListener("cancel",this.onAnimationCancel),this.transitionInAnimation.cancel(),this.transitionInAnimation=void 0),this.transitionOutAnimation&&(this.transitionOutAnimation.removeEventListener("play",this.onAnimationPlay),this.transitionOutAnimation.removeEventListener("finish",this.onAnimationFinish),this.transitionOutAnimation.removeEventListener("cancel",this.onAnimationCancel),this.transitionOutAnimation.cancel(),this.transitionOutAnimation=void 0)}resetStyling(){var t,e;this.style.opacity="",this.style.transform="",this.style.visibility="",null===(t=this.transitionInAnimation)||void 0===t||t.cancel(),null===(e=this.transitionOutAnimation)||void 0===e||e.cancel()}disconnectedCallback(){super.disconnectedCallback(),this.cleanupAnimations()}};let $t=class extends(bt(yt)){constructor(){super(...arguments),this.wasVisible=!1}connectedCallback(){super.connectedCallback(),requestAnimationFrame(()=>{this.layoutRenderer||console.error("[ERROR] LayoutRenderer not found",this)})}updated(t){var e,i,n,r;if(super.updated(t),t.has("document")&&this.document&&"layout-document"===this.document.type&&(this.layoutDocument=this.document.originalDocument,requestAnimationFrame(()=>{this.layoutRenderer&&"function"==typeof this.layoutRenderer.stop&&this.layoutRenderer.stop()})),t.has("currentTimestamp")&&this.layoutRenderer){const t=Math.max(0,Math.floor(this.currentTimestamp)-Math.floor(this.startTimestamp)),s=Math.floor(this.endTimestamp)-Math.floor(this.startTimestamp),o=t>=0&&t<s;this.layoutRenderer.currentTimestamp=t,this.dataset.playlistTimestamp=Math.floor(this.currentTimestamp).toString(),this.layoutRenderer.dataset.playlistTimestamp=Math.floor(this.currentTimestamp).toString(),this.dataset.layoutTimestamp=Math.floor(null!==(e=this.layoutRenderer.currentTimestamp)&&void 0!==e?e:0).toString(),this.layoutRenderer.dataset.layoutTimestamp=Math.floor(null!==(i=this.layoutRenderer.currentTimestamp)&&void 0!==i?i:0).toString(),this.dataset.shouldBeVisible=o.toString(),this.layoutRenderer.dataset.shouldBeVisible=o.toString(),this.dataset.isPlaying=null!==(n=this.layoutRenderer.dataset.isPlaying)&&void 0!==n?n:"false",this.layoutRenderer.dataset.isPlaying=null!==(r=this.layoutRenderer.dataset.isPlaying)&&void 0!==r?r:"false",o&&!this.wasVisible?("function"==typeof this.layoutRenderer.play&&this.layoutRenderer.play().catch(t=>{console.error("[ERROR] Failed to play layout renderer:",t)}),this.wasVisible=!0):!o&&this.wasVisible&&("function"==typeof this.layoutRenderer.stop&&this.layoutRenderer.stop().catch(t=>{console.error("[ERROR] Failed to stop layout renderer:",t)}),this.wasVisible=!1)}}async play(){return this.layoutRenderer?this.isPlaying?Promise.resolve():void await Promise.all([super.play(),(async()=>{"function"==typeof this.layoutRenderer.play&&await this.layoutRenderer.play()})()]):Promise.resolve()}async pause(){if(!this.layoutRenderer)return Promise.resolve();await Promise.all([super.pause(),(async()=>{this.layoutRenderer&&"function"==typeof this.layoutRenderer.pause&&await this.layoutRenderer.pause()})()])}async stop(){await Promise.all([super.stop(),(async()=>{this.layoutRenderer&&"function"==typeof this.layoutRenderer.stop&&await this.layoutRenderer.stop()})()])}async seek(t){if(!this.layoutRenderer)return Promise.resolve();const e=Math.max(0,Math.floor(t)-Math.floor(this.startTimestamp));return"function"==typeof this.layoutRenderer.seek?await this.layoutRenderer.seek(e):this.layoutRenderer.currentTimestamp=e,Promise.resolve()}render(){return super.render(),this.layoutDocument?F`
            <layout-renderer 
                .document=${this.layoutDocument}
                .frameRate=${Math.max(this.frameRate||30,30)}
                .editingMode=${"false"}
                .playbackMode=${"gpu"}
                .zoomFactor=${1}
            ></layout-renderer>
        `:F``}};t([pt("layout-renderer"),e("design:type",Object)],$t.prototype,"layoutRenderer",void 0),t([ct(),e("design:type",Object)],$t.prototype,"layoutDocument",void 0),$t=t([lt("layout-item-renderer")],$t);var At=$t;const wt=[];for(let t=0;t<256;++t)wt.push((t+256).toString(16).slice(1));let Rt;const Tt=new Uint8Array(16);var Et={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function xt(t,e,i){if(Et.randomUUID&&!t)return Et.randomUUID();const n=(t=t||{}).random??t.rng?.()??function(){if(!Rt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Rt=crypto.getRandomValues.bind(crypto)}return Rt(Tt)}();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(t,e=0){return(wt[t[e+0]]+wt[t[e+1]]+wt[t[e+2]]+wt[t[e+3]]+"-"+wt[t[e+4]]+wt[t[e+5]]+"-"+wt[t[e+6]]+wt[t[e+7]]+"-"+wt[t[e+8]]+wt[t[e+9]]+"-"+wt[t[e+10]]+wt[t[e+11]]+wt[t[e+12]]+wt[t[e+13]]+wt[t[e+14]]+wt[t[e+15]]).toLowerCase()}(n)}function Ot(t,e){var i;if(!t)return null;let n=[];const r=(null===(i=null==t?void 0:t.media_type)||void 0===i?void 0:i.split("/")[0])||"";if(!r||"external_link"===r)return null;"video"===r&&n.push(function(t,e){return{id:xt(),type:"video",name:t.name||"",content:{type:"video",src:t.original_file||""},props:{width:t.resolution_width||0,height:t.resolution_height||0,x:0,y:0,background:"transparent"},options:{start:0,end:e||0,visible:!0,locked:!1,selected:!1}}}(t,e)),"audio"===r&&n.push(function(t,e){return{id:xt(),type:"audio",name:t.name||"",content:{type:"audio",src:t.original_file||""},options:{start:0,end:e||0},props:{width:t.resolution_width||0,height:t.resolution_height||0,x:0,y:0,background:"transparent"}}}(t,e)),"image"===r&&n.push(function(t,e){return{id:xt(),type:"image",name:t.name||"",content:{type:"image",src:t.original_file||""},props:{width:t.resolution_width||0,height:t.resolution_height||0,x:0,y:0,background:"transparent"},options:{start:0,end:e||0}}}(t,e));return{version:1,id:xt(),options:{duration:e||0,start:0,end:e||0},children:n,name:t.name||"",type:"layout",props:{width:t.resolution_width||0,height:t.resolution_height||0,background:"transparent"}}}let St=class extends At{constructor(){var t;if(super(),this.document&&"media-asset"===this.document.type){const e=this.document.duration_overwrite||(null===(t=this.document.originalDocument)||void 0===t?void 0:t.duration_ms)||0;this.layoutDocument=Ot(this.document.originalDocument,e)}}async play(){await super.play()}async pause(){await super.pause()}async stop(){await super.stop()}updated(t){var e;if(t.has("document")&&this.document&&"media-asset"===this.document.type){const t=this.document.duration_overwrite||(null===(e=this.document.originalDocument)||void 0===e?void 0:e.duration_ms)||0;this.layoutDocument=Ot(this.document.originalDocument,t)}super.updated(t)}render(){return super.render()}};St=t([lt("asset-item-renderer"),e("design:paramtypes",[])],St);var Pt=St,Dt=Object.getOwnPropertyNames,It=Object.getOwnPropertySymbols,Mt=Object.prototype.hasOwnProperty;function Ct(t,e){return function(i,n,r){return t(i,n,r)&&e(i,n,r)}}function kt(t){return function(e,i,n){if(!e||!i||"object"!=typeof e||"object"!=typeof i)return t(e,i,n);var r=n.cache,s=r.get(e),o=r.get(i);if(s&&o)return s===i&&o===e;r.set(e,i),r.set(i,e);var a=t(e,i,n);return r.delete(e),r.delete(i),a}}function jt(t){return Dt(t).concat(It(t))}var Ut=Object.hasOwn||function(t,e){return Mt.call(t,e)};function qt(t,e){return t===e||!t&&!e&&t!=t&&e!=e}var Nt=Object.getOwnPropertyDescriptor,zt=Object.keys;function Ht(t,e,i){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!i.equals(t[n],e[n],n,n,t,e,i))return!1;return!0}function Ft(t,e){return qt(t.getTime(),e.getTime())}function Lt(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function Bt(t,e){return t===e}function Vt(t,e,i){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var r,s,o=new Array(n),a=t.entries(),l=0;(r=a.next())&&!r.done;){for(var d=e.entries(),u=!1,h=0;(s=d.next())&&!s.done;)if(o[h])h++;else{var c=r.value,p=s.value;if(i.equals(c[0],p[0],l,h,t,e,i)&&i.equals(c[1],p[1],c[0],p[0],t,e,i)){u=o[h]=!0;break}h++}if(!u)return!1;l++}return!0}var Wt=qt;function Kt(t,e,i){var n=zt(t),r=n.length;if(zt(e).length!==r)return!1;for(;r-- >0;)if(!te(t,e,i,n[r]))return!1;return!0}function Zt(t,e,i){var n,r,s,o=jt(t),a=o.length;if(jt(e).length!==a)return!1;for(;a-- >0;){if(!te(t,e,i,n=o[a]))return!1;if(r=Nt(t,n),s=Nt(e,n),(r||s)&&(!r||!s||r.configurable!==s.configurable||r.enumerable!==s.enumerable||r.writable!==s.writable))return!1}return!0}function Jt(t,e){return qt(t.valueOf(),e.valueOf())}function Gt(t,e){return t.source===e.source&&t.flags===e.flags}function Qt(t,e,i){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var r,s,o=new Array(n),a=t.values();(r=a.next())&&!r.done;){for(var l=e.values(),d=!1,u=0;(s=l.next())&&!s.done;){if(!o[u]&&i.equals(r.value,s.value,r.value,s.value,t,e,i)){d=o[u]=!0;break}u++}if(!d)return!1}return!0}function Xt(t,e){var i=t.length;if(e.length!==i)return!1;for(;i-- >0;)if(t[i]!==e[i])return!1;return!0}function Yt(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function te(t,e,i,n){return!("_owner"!==n&&"__o"!==n&&"__v"!==n||!t.$$typeof&&!e.$$typeof)||Ut(e,n)&&i.equals(t[n],e[n],n,n,t,e,i)}var ee=Array.isArray,ie="function"==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,ne=Object.assign,re=Object.prototype.toString.call.bind(Object.prototype.toString);var se=oe();function oe(t){void 0===t&&(t={});var e,i=t.circular,n=void 0!==i&&i,r=t.createInternalComparator,s=t.createState,o=t.strict,a=void 0!==o&&o,l=function(t){var e=t.circular,i=t.createCustomConfig,n=t.strict,r={areArraysEqual:n?Zt:Ht,areDatesEqual:Ft,areErrorsEqual:Lt,areFunctionsEqual:Bt,areMapsEqual:n?Ct(Vt,Zt):Vt,areNumbersEqual:Wt,areObjectsEqual:n?Zt:Kt,arePrimitiveWrappersEqual:Jt,areRegExpsEqual:Gt,areSetsEqual:n?Ct(Qt,Zt):Qt,areTypedArraysEqual:n?Zt:Xt,areUrlsEqual:Yt};if(i&&(r=ne({},r,i(r))),e){var s=kt(r.areArraysEqual),o=kt(r.areMapsEqual),a=kt(r.areObjectsEqual),l=kt(r.areSetsEqual);r=ne({},r,{areArraysEqual:s,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:l})}return r}(t),d=function(t){var e=t.areArraysEqual,i=t.areDatesEqual,n=t.areErrorsEqual,r=t.areFunctionsEqual,s=t.areMapsEqual,o=t.areNumbersEqual,a=t.areObjectsEqual,l=t.arePrimitiveWrappersEqual,d=t.areRegExpsEqual,u=t.areSetsEqual,h=t.areTypedArraysEqual,c=t.areUrlsEqual;return function(t,p,m){if(t===p)return!0;if(null==t||null==p)return!1;var y=typeof t;if(y!==typeof p)return!1;if("object"!==y)return"number"===y?o(t,p,m):"function"===y&&r(t,p,m);var f=t.constructor;if(f!==p.constructor)return!1;if(f===Object)return a(t,p,m);if(ee(t))return e(t,p,m);if(null!=ie&&ie(t))return h(t,p,m);if(f===Date)return i(t,p,m);if(f===RegExp)return d(t,p,m);if(f===Map)return s(t,p,m);if(f===Set)return u(t,p,m);var v=re(t);return"[object Date]"===v?i(t,p,m):"[object RegExp]"===v?d(t,p,m):"[object Map]"===v?s(t,p,m):"[object Set]"===v?u(t,p,m):"[object Object]"===v?"function"!=typeof t.then&&"function"!=typeof p.then&&a(t,p,m):"[object URL]"===v?c(t,p,m):"[object Error]"===v?n(t,p,m):"[object Arguments]"===v?a(t,p,m):("[object Boolean]"===v||"[object Number]"===v||"[object String]"===v)&&l(t,p,m)}}(l),u=r?r(d):(e=d,function(t,i,n,r,s,o,a){return e(t,i,a)});return function(t){var e=t.circular,i=t.comparator,n=t.createState,r=t.equals,s=t.strict;if(n)return function(t,o){var a=n(),l=a.cache,d=void 0===l?e?new WeakMap:void 0:l,u=a.meta;return i(t,o,{cache:d,equals:r,meta:u,strict:s})};if(e)return function(t,e){return i(t,e,{cache:new WeakMap,equals:r,meta:void 0,strict:s})};var o={cache:void 0,equals:r,meta:void 0,strict:s};return function(t,e){return i(t,e,o)}}({circular:n,comparator:d,createState:s,equals:u,strict:a})}oe({strict:!0}),oe({circular:!0}),oe({circular:!0,strict:!0}),oe({createInternalComparator:function(){return qt}}),oe({strict:!0,createInternalComparator:function(){return qt}}),oe({circular:!0,createInternalComparator:function(){return qt}}),oe({circular:!0,createInternalComparator:function(){return qt},strict:!0});let ae=class extends(bt(yt)){constructor(){super(),this.setup()}updated(t){super.updated(t)}async play(){await Promise.all([super.play(),(async()=>{var t,e;return!0===(null===(t=this.playlistRenderer)||void 0===t?void 0:t.isPlaying)||await(null===(e=this.playlistRenderer)||void 0===e?void 0:e.play()),Promise.resolve()})()])}async pause(){await Promise.all([super.pause(),(async()=>{var t,e;return!1===(null===(t=this.playlistRenderer)||void 0===t?void 0:t.isPlaying)||await(null===(e=this.playlistRenderer)||void 0===e?void 0:e.pause()),Promise.resolve()})()])}async stop(){await Promise.all([super.stop(),(async()=>{var t;return await(null===(t=this.playlistRenderer)||void 0===t?void 0:t.stop()),Promise.resolve()})()])}async setup(){this.generatedPlaylistDocument=await this.fetch(),setInterval(async()=>{const t=await this.fetch();se(this.generatedPlaylistDocument,t)||(this.generatedPlaylistDocument=t)},1e3)}async fetch(){return{id:xt(),name:"Dynamic DOOH",metadata:{created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"},properties:{height:1920,width:1080},items:[{id:xt(),name:"Dynamic DOOH",type:"media-asset",originalDocument:{id:xt(),name:"Dynamic DOOH",media_type:"image",original_file:"https://placehold.co/1920x1080/orange/white",resolution_width:1080,resolution_height:1920,duration_ms:2500,file_size_human:"100KB"},created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"},{id:xt(),name:"Dynamic DOOH",type:"media-asset",originalDocument:{id:xt(),name:"Dynamic DOOH",media_type:"image",original_file:"https://placehold.co/1920x1080/blue/white",resolution_width:1080,resolution_height:1920,duration_ms:2500,file_size_human:"100KB"},created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"},{id:xt(),name:"Dynamic DOOH",type:"media-asset",originalDocument:{id:xt(),name:"Dynamic DOOH",media_type:"image",original_file:"https://placehold.co/1920x1080/green/white",resolution_width:1080,resolution_height:1920,duration_ms:5e3,file_size_human:"100KB"},created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"}]}}render(){return super.render(),this.document&&"dynamic-dooh-document"===this.document.type?F`
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                <playlist-renderer
                    .document=${this.generatedPlaylistDocument}
                    .zoomFactor=${1}
                    .frameRate=${this.frameRate}
                    .currentTimestamp=${this.currentTimestamp}
                ></playlist-renderer>
            </div>
        `:F``}};t([pt("playlist-renderer"),e("design:type",Se)],ae.prototype,"playlistRenderer",void 0),t([ct(),e("design:type",Object)],ae.prototype,"generatedPlaylistDocument",void 0),ae=t([lt("dynamic-dooh-item-renderer"),e("design:paramtypes",[])],ae);var le=ae;function de(t){const e=Date.now();return!(t.incept_date&&e<new Date(t.incept_date).getTime())&&!(t.expiry_date&&new Date(t.expiry_date).getTime()<e)}function ue(t){const e=t.items.filter(t=>de(t)),i=e.reduce((e,i)=>e+he(i,t),0),n=e;if(n.length>=2){const t=n[n.length-1],e=n[0];if(t?.transition_out?.overlap||e?.transition_in?.overlap)return i-Math.max(t?.transition_out?.duration||0,e?.transition_in?.duration||0)}return i}function he(t,e){let i=0;if(e){const n=e.items[e.items.findIndex(e=>e.id===t.id)+1],r=n?.transition_in?.overlap&&n.transition_in.duration||0,s=t.transition_out?.overlap&&t.transition_out.duration||0;i=Math.max(r,s)}return t.duration_overwrite?Math.max(0,t.duration_overwrite-i):"playlist-document"===t.type&&t.originalDocument?Math.max(0,ue(t.originalDocument)-i):"layout-document"===t.type&&t.originalDocument&&t.originalDocument.options.hasOwnProperty("duration")?Math.max(0,(t.originalDocument.options.duration||0)-i):"media-asset"===t.type&&t.originalDocument&&t.originalDocument.hasOwnProperty("duration_ms")?Math.max(0,(t.originalDocument.duration_ms||0)-i):0}const ce=t=>class extends t{dispatchRendererEvent(t,e,i,n,r){const s={timestamp:e,rendererType:i,document:n,...r},o=`renderer:${t}`;this.dispatchEvent(new CustomEvent(o,{detail:s,bubbles:!0,composed:!0}))}};let pe=class extends(bt(yt)){updated(t){super.updated(t),t.has("document")&&this.document&&"playlist-document"===this.document.type&&(this.playlistDocument=this.document.originalDocument)}getWrappedTimestamp(){if(!this.playlistDocument)return 0;const t=Math.max(0,Math.floor(this.currentTimestamp)-Math.floor(this.startTimestamp)),e=Math.floor(ue(this.playlistDocument));return e<=0?0:t%e}async play(){await Promise.all([super.play(),(async()=>{var t,e;return!0===(null===(t=this.playlistRenderer)||void 0===t?void 0:t.isPlaying)||await(null===(e=this.playlistRenderer)||void 0===e?void 0:e.play()),Promise.resolve()})()])}async pause(){await Promise.all([super.pause(),(async()=>{var t,e;return!1===(null===(t=this.playlistRenderer)||void 0===t?void 0:t.isPlaying)||await(null===(e=this.playlistRenderer)||void 0===e?void 0:e.pause()),Promise.resolve()})()])}async stop(){await Promise.all([super.stop(),(async()=>{var t;return await(null===(t=this.playlistRenderer)||void 0===t?void 0:t.stop()),Promise.resolve()})()])}render(){if(super.render(),!this.document||"playlist-document"!==this.document.type)return F``;if(!this.playlistDocument)return F``;this.style.width="100%",this.style.height="100%";const t=this.getWrappedTimestamp();return F`
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                <playlist-renderer
                    style="width: 100%; height: 100%;"
                    .document=${this.playlistDocument}
                    .zoomFactor=${1}
                    .frameRate=${this.frameRate}
                    .currentTimestamp=${t}
                ></playlist-renderer>
            </div>
        `}};t([pt("playlist-renderer"),e("design:type",Se)],pe.prototype,"playlistRenderer",void 0),pe=t([lt("playlist-item-renderer")],pe);let me=class extends(bt(yt)){constructor(){super(),this.setup()}updated(t){super.updated(t)}async play(){await Promise.all([super.play(),(async()=>{var t,e;return!0===(null===(t=this.playlistRenderer)||void 0===t?void 0:t.isPlaying)||await(null===(e=this.playlistRenderer)||void 0===e?void 0:e.play()),Promise.resolve()})()])}async pause(){await Promise.all([super.pause(),(async()=>{var t,e;return!1===(null===(t=this.playlistRenderer)||void 0===t?void 0:t.isPlaying)||await(null===(e=this.playlistRenderer)||void 0===e?void 0:e.pause()),Promise.resolve()})()])}async stop(){await Promise.all([super.stop(),(async()=>{var t;return await(null===(t=this.playlistRenderer)||void 0===t?void 0:t.stop()),Promise.resolve()})()])}setup(){this.generatedPlaylistDocument={id:xt(),name:"Static DOOH",metadata:{created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"},properties:{height:1920,width:1080},items:[{id:xt(),name:"Static DOOH",type:"media-asset",originalDocument:{id:xt(),name:"Static DOOH",media_type:"image",original_file:"https://placehold.co/1920x1080/purple/white",resolution_width:1080,resolution_height:1920,duration_ms:2500,file_size_human:"100KB"},created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"},{id:xt(),name:"Static DOOH",type:"media-asset",originalDocument:{id:xt(),name:"Static DOOH",media_type:"image",original_file:"https://placehold.co/1920x1080/pink/white",resolution_width:1080,resolution_height:1920,duration_ms:2500,file_size_human:"100KB"},created_at:(new Date).toISOString(),created_by:"system",last_edited_at:(new Date).toISOString(),last_edited_by:"system"}]}}render(){return super.render(),this.document&&"static-dooh-document"===this.document.type?F`
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                <playlist-renderer
                    .document=${this.generatedPlaylistDocument}
                    .zoomFactor=${1}
                    .frameRate=${this.frameRate}
                    .currentTimestamp=${this.currentTimestamp}
                ></playlist-renderer>
            </div>
        `:F``}};function ye(t){return!de(t)}function fe(t){var e,i,n,r;const s=t.items.filter(t=>!ye(t));if(s.length<2)return 0;const o=s[s.length-1],a=s[0];return(null===(e=null==o?void 0:o.transition_out)||void 0===e?void 0:e.overlap)||(null===(i=null==a?void 0:a.transition_in)||void 0===i?void 0:i.overlap)?Math.max((null===(n=null==o?void 0:o.transition_out)||void 0===n?void 0:n.duration)||0,(null===(r=null==a?void 0:a.transition_in)||void 0===r?void 0:r.duration)||0):0}function ve(t){var e,i;const n=t.items.filter(t=>!ye(t));if(n.length<2)return!1;const r=n[n.length-1],s=n[0];return(null===(e=null==r?void 0:r.transition_out)||void 0===e?void 0:e.overlap)||(null===(i=null==s?void 0:s.transition_in)||void 0===i?void 0:i.overlap)||!1}function ge(t,e,i){return{startTimestamp:t-i,endTimestamp:t+e}}function _e(t){var e;if(void 0===(null===(e=t.properties)||void 0===e?void 0:e.startIndex)||null===t.properties.startIndex||0===t.properties.startIndex)return t;const i=t.properties.startIndex;if(0===t.items.length)return t;const n=i%t.items.length;if(0===n)return t;const r=[...t.items.slice(n),...t.items.slice(0,n)];return{...t,items:r}}function be(t,e){var i,n,r,s;let o=0;for(let a=1;a<=e;a++){const e=t.items[a],l=t.items[a-1];if(!e||!l)continue;o+=(null===(i=null==l?void 0:l.transition_out)||void 0===i?void 0:i.overlap)||(null===(n=e.transition_in)||void 0===n?void 0:n.overlap)?Math.max((null===(r=null==l?void 0:l.transition_out)||void 0===r?void 0:r.duration)||0,(null===(s=e.transition_in)||void 0===s?void 0:s.duration)||0):0}return o}function $e(t,e,i,n){const r=e.items.indexOf(t),s=e.items.slice(0,r).filter(t=>de(t)).reduce((t,e)=>t+he(e),0);if(!de(t))return s-be(e,r);let o=s;return o-=be(e,r),o}function Ae(t,e,i,n){const r=$e(t,e);if(!de(t))return r;return r+he(t)}function we(t){return!de(t)}function Re(t,e){var i,n,r;const s=we(t.document),o=t.parentDocument;let a,l;Te(t),Ee(t),a=$e(t.document,t.parentDocument),l=Ae(t.document,t.parentDocument);const d=ue(o);a<0&&(a=d+a),l<0&&(l=d+l);let u=!s&&a!==l;if(o&&(null===(i=o.items.filter(t=>!we(t))[0])||void 0===i?void 0:i.id)===t.document.id&&o){const i=o.items.filter(t=>!we(t));if(i.length>=2){const d=i[i.length-1],h=i[0];if((null===(n=null==d?void 0:d.transition_out)||void 0===n?void 0:n.overlap)||(null===(r=null==h?void 0:h.transition_in)||void 0===r?void 0:r.overlap)||!1){const i=ue(o),n=i-fe(o),r=he(h,o);return a=n,l=i+r,e>=n||e<r?(u=!0,t.style.zIndex="999999"):u=!1,{isVisible:u,isExpired:s,startTimestamp:a,endTimestamp:l}}}}return a<l?u=u&&a<=e&&l>e:a>=l&&(u=u&&(a<=e||l>e)),{isVisible:u,isExpired:s,startTimestamp:a,endTimestamp:l}}function Te(t){const e=t.parentDocument,i=(null==e?void 0:e.items.filter(t=>!we(t)))||[],n=i.findIndex(e=>e.id===t.document.id),r=!!e&&fe(e)>0;return 0===n&&i.length>1&&r?i[i.length-1]:n>0?i[n-1]:null}function Ee(t){const e=t.parentDocument,i=(null==e?void 0:e.items.filter(t=>!we(t)))||[],n=i.findIndex(e=>e.id===t.document.id),r=!!e&&fe(e)>0;return n===i.length-1&&i.length>1&&r?i[0]:-1!==n&&n<i.length-1?i[n+1]:null}t([pt("playlist-renderer"),e("design:type",Se)],me.prototype,"playlistRenderer",void 0),t([ct(),e("design:type",Object)],me.prototype,"generatedPlaylistDocument",void 0),me=t([lt("static-dooh-item-renderer"),e("design:paramtypes",[])],me);const xe={"media-asset":Pt,"layout-document":At,"playlist-document":pe,"dynamic-dooh-document":le,"static-dooh-document":me};class Oe{constructor(){this.itemRenderers=new Map,this.currentTimestamp=0,this.isPlaying=!1,this.zoomFactor=1,this.frameRate=30,this.currentlyPlayingItemId=null}setItemCallbacks(t){this.onItemStart=t.onItemStart,this.onItemEnd=t.onItemEnd}play(){this.isPlaying=!0,this.itemRenderers.forEach(({renderer:t})=>{const{isVisible:e}=Re(t,this.currentTimestamp);e?(t.play().then(()=>{}),t.style.display="block"):(t.pause().then(()=>{}),t.style.display="none")})}pause(){this.isPlaying=!1,this.itemRenderers.forEach(({renderer:t})=>{t.pause().then(()=>{})})}stop(){this.isPlaying=!1,this.currentlyPlayingItemId=null,this.itemRenderers.forEach(({renderer:t})=>{t.stop().then(()=>{})})}seek(t){this.currentTimestamp=t,Array.from(this.itemRenderers.values()).filter(({renderer:t})=>!we(t.document)).forEach(({renderer:e,order:i})=>{var n,r,s;const{isVisible:o,startTimestamp:a,endTimestamp:l}=Re(e,t),d=e.parentDocument;if(d&&(null===(n=d.items.filter(t=>!we(t))[0])||void 0===n?void 0:n.id)===e.document.id&&d){const i=d.items.filter(t=>!we(t));if(i.length>=2){const n=i[i.length-1],o=i[0];if((null===(r=null==n?void 0:n.transition_out)||void 0===r?void 0:r.overlap)||(null===(s=null==o?void 0:o.transition_in)||void 0===s?void 0:s.overlap)||!1){const i=ue(d),n=i-fe(d);t>=n?e.currentTimestamp=n+(t-n):t<he(o,d)?e.currentTimestamp=i+t:e.currentTimestamp=t}else e.currentTimestamp=t}else e.currentTimestamp=t}else e.currentTimestamp=t;o?(e.style.display="block","function"==typeof e.seek&&e.seek(e.currentTimestamp)):e.style.display="none",a===e.startTimestamp&&l===e.endTimestamp||(e.startTimestamp=a,e.endTimestamp=l,e.order=i,this.itemRenderers.set(e.document.id,{renderer:e,order:i,startTimestamp:a,endTimestamp:l}))})}updateCurrentTimestamp(t){this.currentTimestamp=t;let e=null;if(Array.from(this.itemRenderers.values()).filter(({renderer:t})=>!we(t.document)).forEach(({renderer:i,order:n})=>{var r,s,o;const{isVisible:a,startTimestamp:l,endTimestamp:d}=Re(i,t),u=i.parentDocument;if(u&&(null===(r=u.items.filter(t=>!we(t))[0])||void 0===r?void 0:r.id)===i.document.id&&u){const e=u.items.filter(t=>!we(t));if(e.length>=2){const n=e[e.length-1],r=e[0];if((null===(s=null==n?void 0:n.transition_out)||void 0===s?void 0:s.overlap)||(null===(o=null==r?void 0:r.transition_in)||void 0===o?void 0:o.overlap)||!1){const e=ue(u),n=e-fe(u);t>=n?i.currentTimestamp=n+(t-n):t<he(r,u)?i.currentTimestamp=e+t:i.currentTimestamp=t}else i.currentTimestamp=t}else i.currentTimestamp=t}else i.currentTimestamp=t;a&&(e||(e=i.document.id)),l===i.startTimestamp&&d===i.endTimestamp||(i.startTimestamp=l,i.endTimestamp=d,i.order=n,this.itemRenderers.set(i.document.id,{renderer:i,order:n,startTimestamp:l,endTimestamp:d})),this.isPlaying&&(a?(i.play().then(()=>{}),i.style.display="block"):(i.stop().then(()=>{}),i.style.display="none"))}),this.isPlaying&&e!==this.currentlyPlayingItemId){const t=Array.from(this.itemRenderers.values()).filter(({renderer:t})=>!we(t.document)).sort((t,e)=>t.order-e.order);if(this.currentlyPlayingItemId&&this.onItemEnd){const e=this.itemRenderers.get(this.currentlyPlayingItemId);if(e){const i=t.findIndex(t=>t.renderer.document.id===this.currentlyPlayingItemId);this.onItemEnd(e.renderer.document,i,t.length)}}if(e&&this.onItemStart){const i=this.itemRenderers.get(e);if(i){const n=t.findIndex(t=>t.renderer.document.id===e);this.onItemStart(i.renderer.document,n,t.length)}}this.currentlyPlayingItemId=e}}buildRenderer(t,e=null){const i=_e(t),n=document.createElement("div");n.style.width=`${i.properties.width}px`,n.style.height=`${i.properties.height}px`,n.style.overflow="hidden",n.style.position="relative",e&&(n.style.scale=`${this.zoomFactor}`);return i.items.filter(t=>!we(t)).reduce((t,e,i,n)=>(t.push(e),1===n.length&&t.push(e),t),[]).map((t,e)=>this.buildSubRenderer(t,i,e)).forEach((t,e)=>{this.itemRenderers.set(t.document.id,{renderer:t,order:e,startTimestamp:t.startTimestamp,endTimestamp:t.endTimestamp}),n.appendChild(t)}),ue(i),this.rootRenderer=n,n}updateRenderer(t,e=null){return this.itemRenderers=new Map,this.buildRenderer(t,e)}setZoomFactor(t){this.zoomFactor=t,this.itemRenderers.forEach(({renderer:t})=>{t.zoomFactor=this.zoomFactor})}setFrameRate(t){this.frameRate=t}buildSubRenderer(t,e,i){const n=new xe[t.type];n.document=t,n.parentDocument=e,n.zoomFactor=this.zoomFactor,n.frameRate=this.frameRate,n.currentTimestamp=this.currentTimestamp,n.style.position="absolute",n.style.top="0",n.style.left="0";const r=100*(e.items.length+1-i);n.style.zIndex=r.toString();const{isVisible:s,startTimestamp:o,endTimestamp:a}=Re(n,this.currentTimestamp);return n.startTimestamp=o,n.endTimestamp=a,n.order=i,n.style.display=s?"block":"none",n}}let Se=class extends(ce(ot)){constructor(){super(),this.document=null,this.zoomFactor=1,this.currentTimestamp=0,this.frameRate=30,this.parentDocument=null,this.isPlaying=!1,this.renderer=null,this.currentTimestampInterval=null,this.documentDuration=0,this.pendingReload=!1,this.loopCount=0,this.rendererManager=new Oe,this.rendererManager.setItemCallbacks({onItemStart:(t,e,i)=>{this.dispatchRendererEvent("playlist-item-start",Date.now(),"playlist",this.document,{item:t,itemIndex:e,totalItems:i})},onItemEnd:(t,e,i)=>{this.dispatchRendererEvent("playlist-item-end",Date.now(),"playlist",this.document,{item:t,itemIndex:e,totalItems:i})}})}connectedCallback(){if(super.connectedCallback(),this.document){this.renderer=this.rendererManager.buildRenderer(this.getDocumentWithStartIndex(),this.parentDocument),this.documentDuration=ue(this.document);const t=this.document.items.filter(t=>de(t));this.dispatchRendererEvent("ready",Date.now(),"playlist",this.document,{duration:this.documentDuration,itemCount:t.length})}this.rendererManager.setZoomFactor(this.zoomFactor),this.rendererManager.setFrameRate(this.frameRate),this.rendererManager.updateCurrentTimestamp(this.currentTimestamp)}disconnectedCallback(){super.disconnectedCallback(),this.clear()}checkAndScheduleReload(){this.document&&this.hasPlaylistChanged()&&(this.pendingReload=!0)}hasPlaylistChanged(){if(!this.document)return!1;const t=new Set(Array.from(this.rendererManager.itemRenderers.keys())),e=new Set(this.document.items.filter(t=>{const e=Date.now(),i=!t.incept_date||new Date(t.incept_date).getTime()<=e,n=!t.expiry_date||new Date(t.expiry_date).getTime()>=e;return i&&n}).map(t=>t.id));if(t.size!==e.size)return!0;for(const i of t)if(!e.has(i))return!0;return!1}applyPendingReload(){if(this.pendingReload&&this.document){const t=this.isPlaying;this.renderer=this.rendererManager.updateRenderer(this.document,this.parentDocument),this.documentDuration=ue(this.document),this.pendingReload=!1,t&&this.rendererManager.play(),this.requestUpdate()}}clear(){clearInterval(this.currentTimestampInterval),this.rendererManager.stop()}getDocumentWithStartIndex(){return this.document?void 0!==this.startIndex&&null!==this.startIndex?{...this.document,properties:{...this.document.properties,startIndex:this.startIndex}}:this.document:null}updated(t){if(void 0!==this.document&&((t.has("document")||t.has("startIndex"))&&(this.renderer=this.rendererManager.updateRenderer(this.getDocumentWithStartIndex(),this.parentDocument),this.documentDuration=ue(this.document),this.loopCount=0,this.requestUpdate()),t.has("zoomFactor")&&(this.rendererManager.setZoomFactor(this.zoomFactor),this.requestUpdate()),t.has("frameRate")&&(this.rendererManager.setFrameRate(this.frameRate),this.requestUpdate()),t.has("currentTimestamp"))){const t=ue(this.document);t!==this.documentDuration&&(this.documentDuration=t),this.rendererManager.updateCurrentTimestamp(this.currentTimestamp),this.requestUpdate()}}play(){this.isPlaying=!0;const t=1e3/this.frameRate;let e=!1;const i=()=>{const i=this.currentTimestamp+t,n=this.document?fe(this.document):0,r=this.documentDuration-n;!e&&this.currentTimestamp<r&&i>=r&&(this.checkAndScheduleReload(),e=!0),i>=this.documentDuration?(this.applyPendingReload(),this.currentTimestamp=i-this.documentDuration,e=!1,this.loopCount++,this.dispatchRendererEvent("loop",Date.now(),"playlist",this.document,{loopCount:this.loopCount,duration:this.documentDuration})):this.currentTimestamp=i,this.rendererManager.updateCurrentTimestamp(i),this.requestUpdate()};return this.rendererManager.play(),i(),this.currentTimestampInterval=setInterval(i,t),this.dispatchRendererEvent("play",Date.now(),"playlist",this.document),Promise.resolve()}pause(){return this.isPlaying?(this.isPlaying=!1,clearInterval(this.currentTimestampInterval),this.rendererManager.pause(),this.dispatchRendererEvent("pause",Date.now(),"playlist",this.document),Promise.resolve()):Promise.resolve()}stop(){return this.isPlaying=!1,clearInterval(this.currentTimestampInterval),this.rendererManager.stop(),this.currentTimestamp=0,this.rendererManager.updateCurrentTimestamp(this.currentTimestamp),this.loopCount=0,this.dispatchRendererEvent("stop",Date.now(),"playlist",this.document),Promise.resolve()}seek(t){return this.currentTimestamp=t,this.rendererManager.seek(t),Promise.resolve()}render(){var t,e,i,n,r,s,o,a,l,d,u,h,c,p;return(null===(e=null===(t=this.document)||void 0===t?void 0:t.properties)||void 0===e?void 0:e.isMPV)?F``:(this.style.display="block",this.style.scale=`${this.zoomFactor}`,void 0!==(null===(n=null===(i=this.document)||void 0===i?void 0:i.properties)||void 0===n?void 0:n.height)&&void 0!==(null===(s=null===(r=this.document)||void 0===r?void 0:r.properties)||void 0===s?void 0:s.width)||console.error("[ERROR] PlaylistRenderer: document properties are not defined"),this.style.height=`${(null===(a=null===(o=this.parentDocument)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.height)||(null===(d=null===(l=this.document)||void 0===l?void 0:l.properties)||void 0===d?void 0:d.height)||0}px`,this.style.width=`${(null===(h=null===(u=this.parentDocument)||void 0===u?void 0:u.properties)||void 0===h?void 0:h.width)||(null===(p=null===(c=this.document)||void 0===c?void 0:c.properties)||void 0===p?void 0:p.width)||0}px`,this.style.overflow="hidden",this.renderer?F`${this.renderer}`:F``)}};t([ht({type:Object}),e("design:type",Object)],Se.prototype,"document",void 0),t([ht({type:Number}),e("design:type",Number)],Se.prototype,"zoomFactor",void 0),t([ht({type:Number}),e("design:type",Number)],Se.prototype,"currentTimestamp",void 0),t([ht({type:Number}),e("design:type",Number)],Se.prototype,"frameRate",void 0),t([ht({type:Object}),e("design:type",Object)],Se.prototype,"parentDocument",void 0),t([ht({type:Number}),e("design:type",Number)],Se.prototype,"startIndex",void 0),t([ct(),e("design:type",Boolean)],Se.prototype,"isPlaying",void 0),t([ct(),e("design:type",HTMLElement)],Se.prototype,"renderer",void 0),Se=t([lt("playlist-renderer"),e("design:paramtypes",[])],Se);export{ce as RendererEventsMixin,_e as applyPlaybackOrder,ge as calculateLoopItemTiming,Se as default,Ee as getItemAfter,Te as getItemBefore,Ae as getItemEndTimestampInPlaylist,$e as getItemStartTimestampInPlaylist,Re as getItemVisibility,fe as getLoopTransitionOverlap,ue as getPlaylistDuration,he as getPlaylistItemDuration,we as isExpired,de as isItemActive,ye as isItemExpired,ve as shouldCreateLoopItem};
//# sourceMappingURL=index.js.map
